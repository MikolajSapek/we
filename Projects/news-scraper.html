<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>News Site Aggregator Project - Mikolaj Pawel Sapek Portfolio</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
		<style>
			/* Dark Mode Styles */
			body.dark-mode {
				background-color: #1a1a1a;
				color: #e0e0e0;
			}
			
			body.dark-mode #main {
				background-color: #2a2a2a;
				color: #e0e0e0;
			}
			
			body.dark-mode #main > * {
				border-top-color: #404040;
			}
			
			body.dark-mode h1, body.dark-mode h2, body.dark-mode h3, 
			body.dark-mode h4, body.dark-mode h5, body.dark-mode h6 {
				color: #ffffff;
			}
			
			body.dark-mode a {
				color: #e0e0e0;
				border-bottom-color: rgba(224, 224, 224, 0.5);
			}
			
			body.dark-mode a:hover {
				color: #18bfef !important;
			}
			
			body.dark-mode #header {
				background-color: #1a1a1a;
			}
			
			body.dark-mode #nav {
				background-color: #1a1a1a;
			}
			
			body.dark-mode #footer {
				background-color: #1a1a1a;
				color: #e0e0e0;
			}
			
			body.dark-mode #copyright {
				background-color: #1a1a1a;
				color: #e0e0e0;
			}
			
			body.dark-mode .button {
				color: #ffffff !important;
				border-color: #ffffff !important;
				border-style: solid !important;
				box-shadow: inset 0 0 0 2px #ffffff !important;
			}
			
			body.dark-mode .button:hover {
				background-color: #ffffff !important;
				color: #1a1a1a !important;
				border-color: #ffffff !important;
				box-shadow: inset 0 0 0 2px #ffffff !important;
			}
			
			body.dark-mode strong, body.dark-mode b {
				color: #ffffff !important;
			}
			
			/* Dark mode toggle button */
			#dark-mode-toggle {
				transition: transform 0.2s ease;
				cursor: pointer;
			}
			
			#dark-mode-toggle:hover {
				transform: scale(1.1);
			}
		</style>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="../index.html" class="logo">Portfolio</a>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="../index.html">Projects</a></li>
							<li class="active"><a href="news-scraper.html">News Site Aggregator</a></li>
							<li><a href="../aboutme.html">About Me</a></li>
							<li><a href="../cv.html">CV</a></li>
						</ul>
						<ul class="icons">
							<li><a href="https://www.linkedin.com/in/miko%C5%82aj-pawe%C5%82-sapek-8b5633267/" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
							<li><a href="https://www.facebook.com/profile.php?id=100009058364906" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
							<li id="dark-mode-toggle" style="cursor: pointer; padding: 0.5em;">
								<span class="icon solid fa-moon" id="dark-mode-icon"></span>
							</li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<section class="post">
								<header class="major">
									<h1>News Site Aggregator<br />
									Project</h1>
									<p>Automatic aggregator for real estate industry news that periodically collects articles from selected websites (including Eurobuild CEE, PropertyInsider), cleans HTML, extracts key fields using CSS selectors, and structures data through AI modules, then optionally sends them to a backend API.</p>
								</header>
								<div class="image main"><img src="../images/meta-image-redd.png" alt="News Site Aggregator Project" style="max-width: 70%; margin: 0 auto; display: block;" /></div>
								
								<h2>Overview</h2>
								<p>An automatic aggregator for real estate industry news that periodically collects articles from selected websites (including Eurobuild CEE, PropertyInsider), cleans HTML, extracts key fields using CSS selectors, and structures data through AI modules, then optionally sends them to a backend API.</p>
								<p>The workflow includes aggregating article lists, filtering by Poland market, fetching detailed content, parsing dates, merging streams, and unified output with leasing/sales/construction data, ready for publication or analytics.</p>
								
								<h2>Technology Stack</h2>
								<p>The project leverages n8n workflow automation and AI-powered data processing:</p>
								<ul>
									<li><strong>n8n Workflow Automation:</strong> Schedule Trigger, HTTP Request, HTML Extract, Merge, IF, Code (Node.js), Sticky Notes for in-flow documentation</li>
									<li><strong>AI Parsing:</strong> gpt-4o-mini via n8n LangChain nodes, Structured Output Parser for consistent JSON</li>
									<li><strong>CSS Selectors:</strong> Lists and articles from Eurobuild and PropertyInsider, href attributes, dates, titles, content</li>
									<li><strong>Backend Integration:</strong> HTTP POST to api.reddplatform.com/news-scraper/ with batching</li>
								</ul>

								<h2>Key Features</h2>
								<ul>
									<li>Data harmonization from multiple sources: fetching links, dates, locations, and content, then merging by entries</li>
									<li>Market filtering: regex on news links and Location=Poland condition to maintain local relevance</li>
									<li>AI structuring: rigid JSON schemas for Property Type, Leasing, Sales, Construction, Certificates, and Market</li>
									<li>Date normalization: conversions and time filters in Code node for yesterday's publications</li>
								</ul>

								<h2>Functionality</h2>
								<p>The aggregator performs the following operations:</p>
								<ul>
									<li>Aggregating categories (Magazines and Offices) from Eurobuild and analogous sections from PropertyInsider</li>
									<li>Fetching detailed articles with full HTML and extracting titles and content</li>
									<li>Deduplication and merging data streams into a single table of records ready for publication</li>
									<li>Sending results to API in established payload (title, content, date, category, link, market, leasing info)</li>
								</ul>

								<h2>Challenges & Solutions</h2>
								<p>Key challenges encountered and solutions implemented:</p>
								<ul>
									<li><strong>Different DOM structures and selectors:</strong> Created separate HTML Extract paths for each website section and clear selectors for links, dates, and content</li>
									<li><strong>Noise and missing data:</strong> AI Output Parser enforces complete structure with empty fields to avoid breaking downstream schema</li>
									<li><strong>Dates in local formats:</strong> Code node normalizes range and filters "yesterday" with Polish month names</li>
									<li><strong>Incorrect categorization:</strong> Prompt rules and keywords limit hallucinations and enforce caution in assignments</li>
								</ul>

								<h2>Code Example</h2>
								<p>Date filtering logic for articles from yesterday (Polish month names). Click below to view the code:</p>
								
								<details>
									<summary style="cursor: pointer; font-weight: bold; margin: 1em 0; padding: 0.5em; background: #f4f4f4; border-radius: 4px;">Click to expand Code Example</summary>
									<pre style="margin-top: 1em;"><code>// Filter: articles from yesterday (PL months)
const currentDate = new Date();
const previousDay = new Date();
previousDay.setDate(currentDate.getDate() - 1);
previousDay.setHours(0,0,0,0);

const endOfPreviousDay = new Date(previousDay);
endOfPreviousDay.setHours(23,59,59,999);

const months = ["stycznia","lutego","marca","kwietnia","maja","czerwca",
                "lipca","sierpnia","września","października","listopada","grudnia"];

const fmt = d => `${d.getDate().toString().padStart(2,'0')} ${months[d.getMonth()]} ${d.getFullYear()}`;

console.log("Checking articles from:", fmt(previousDay));

const filtered = items.filter(it => {
  const s = it.json["Date"];
  if (!s) return false;
  const [d, m, y] = s.trim().split(" ");
  const mi = months.indexOf(m.toLowerCase());
  const dt = new Date(parseInt(y), mi, parseInt(d));
  return dt >= previousDay && dt <= endOfPreviousDay;
});

return filtered.map(it => ({ json: { date: it.json["Date"], link: it.json["Link"] } }));</code></pre>
								</details>

								<h2>AI Structured Output Parser Prompt</h2>
								<p>The system uses detailed prompts to ensure consistent JSON output structure. Click below to view the full prompt instructions:</p>
								
								<details>
									<summary style="cursor: pointer; font-weight: bold; margin: 1em 0; padding: 0.5em; background: #f4f4f4; border-radius: 4px;">Click to expand AI Prompt Instructions</summary>
									<pre style="margin-top: 1em; max-height: 600px; overflow-y: auto;"><code>You are a real estate consultant specializing in urban residential properties and an experienced industry copywriter. Your task is to analyze an article and structure the information in the given format.

**Leasing**
Tenant Name:
Keywords: tenant, lessee, company, firm, organization, occupier, client

Lease Area:
Keywords: area, space, square meters, sqm, m², floor space, leased area, rental space

Lease Start Date:
Output only the date in format: day number + abbreviated month + year, e.g., 15 Jul 2025.
Do not add any words, descriptions, or prefixes like "start:", "on" etc. If missing – leave empty.
Keywords: lease start, move-in date, occupancy date, start date, beginning of lease

Lease Duration:
Keywords: lease period, contract length, duration, short-term, up to 1 year, contract, multi-year agreement, flexible terms

Agency Representing Tenant:
Keywords: agency, intermediary, advisory firm, representation, advisor, broker, intermediation, leasing manager

Building Owner:
Keywords: owner, investor, developer, property manager, fund, property manager

Floor:
Keywords: floor, level, storey, floor layout, floor plan, floor arrangement

Contract Type:
Keywords: new contract, renegotiation, expansion, short-term contract, extension, flexible contract, flex lease, contract signing

If there are multiple tenants, buildings, or other information in this section – list all values in one line, separated by commas.

**Sale**
Building:
(Always check if the building name refers to leasing, sale, or construction)
Keywords: sale, sold, buyer, sale transaction, portfolio sale, capital transaction

Price:
Keywords: price, value, transaction amount, valued at, market value, contract value, investment worth, realization cost

Seller:
Keywords: seller, owner, vendor, seller's fund, developer, current owner

Buyer:
Keywords: buyer, investor, purchaser, fund, new owner, foreign fund

**Construction**
Building Name:
(Required proper name, cannot be company name. Check if it refers to leasing, sale, or construction)
Keywords: name, property, park, investment, complex, office complex, warehouse investment

Construction Status:
(Provide only one word: Start or Completion. If missing – leave empty)
Keywords: started, completed, in progress, progress status, groundbreaking, handed over, in preparation, status, topping out

Construction Area:
(Provide construction area, e.g., 12,000 sqm. If missing – leave empty)
Keywords: construction area, planned area, target m², GLA, NLA, usable area, gross area, net area, total area

Construction Start Date:
Output only the date in format: day number + abbreviated month + year, e.g., 19 May 2025.
Do not add any words, descriptions, or prefixes. If missing – leave empty.
Keywords: construction start, investment start, groundbreaking, start of realization

Planned Building Handover:
Output only the date in format: day number + abbreviated month + year, e.g., 15 Dec 2026.
Do not add any additional information or descriptive text. If missing – leave empty.
Keywords: planned completion, handover plan, realization deadline, handover, acceptance, space transfer, occupancy permit

**Summary**
Based on the content in {{ $json.content }}, generate a concise article summary.
(Maximum length: 300 characters)
Always generate a summary, even if the text is short, incomplete, or general.

**Certificates**
Certificate Name and Level:
List all certificates assigned to buildings mentioned in the article, e.g., BREEAM Excellent, LEED Gold, WiredScore Platinum, SmartScore Certified.
If multiple – separate with commas. If missing – leave empty.
Keywords: sustainability, ESG, certificate, DGNB, BREEAM, LEED, WELL, green buildings, barrier-free property

**Market:**
Based on building or investment location, match the appropriate market from the lists below.
If location cannot be unambiguously assigned – leave field empty.

Warehouses:
Warsaw, Upper Silesia, Central Poland, Wrocław, Poznań, Tricity, Bydgoszcz and Toruń, Kielce, Kraków, Lublin, Opole, Eastern Poland, Western Poland, Rzeszów, Szczecin

Offices:
Warsaw, Kraków, Wrocław, Tricity, Katowice, Poznań, Łódź, Białystok, Bielsko-Biała, Bydgoszcz, Bytom, Chorzów, Częstochowa, Elbląg, Gdańsk, Gdynia, Gliwice, Gniezno, Gorzów Wielkopolski, Jaworzno, Katowice and Metropolis, Kielce, Koszalin, Legnica, Lublin, Olsztyn, Opole, Radom, Rybnik, Rzeszów, Sopot, Sosnowiec, Stalowa Wola, Stargard, Szczecin, Toruń, Trzebinia, Tychy, Wałbrzych, Włocławek, Zabrze, Zamość, Zielona Góra

Return only one market name, best matched to the location in the article. If there are insufficient location data – leave field empty.

Carefully analyze the context and data contained in the article.
Do not rely solely on keywords – always consider the meaning of entire sentences and relationships between information.
Ensure that assigned information is consistent with the category (leasing, sale, construction) and is not a result of incorrect matching.
If data is ambiguous, be cautious and do not force assignments.

Based on the above data, generate the response exactly in the following JSON format. Do not add any additional descriptions, headers, code markers, or comments. Return only a clean JSON object, starting with { and ending with }. Do not use any Markdown formatting or text around it.</code></pre>
								</details>

								<h2>Results & Outcomes</h2>
								<p>The project delivers significant value:</p>
								<ul>
									<li>Consistent JSON for publication and analysis: each record has title, date, link, category, market, and Leasing/Sales/Construction sections</li>
									<li>Reduction of manual work: automation of news processing and metadata extraction ready for CRM/Notion/DB</li>
									<li>Stable pipeline: harmonization of selectors and parsers minimizes errors when layout changes occur</li>
								</ul>

								<h2>Project Highlights</h2>
								<ul>
									<li>Rigid structured output schemas with complete field order, zero missing structure</li>
									<li>Location filters and regex for news articles from Poland</li>
									<li>Multi-source merge, batch POST to API, and preparation for nightly scheduling</li>
								</ul>

								<h2>Use Cases</h2>
								<p>This tool is valuable for:</p>
								<ul>
									<li>Daily news feeds for internal dashboards</li>
									<li>Automatic entries to CMS/Notion with ready transaction fields</li>
									<li>Monitoring leasing/sales/construction for research and market reports</li>
								</ul>

								<h2>Visualizations</h2>
								<div class="box alt">
									<div class="row gtr-50 gtr-uniform">
										<div class="col-12">
											<h3>n8n Workflow Diagram - Property News Aggregator</h3>
											<p><em>Complete workflow showing main branches (Eurobuild/PropertyInsider/PropertyNews) + merge and output, including Property News Aggregator nodes</em></p>
											<span class="image fit"><img src="../images/Screenshot 2025-11-04 at 19.51.37.png" alt="n8n Workflow Diagram - Property News Aggregator" style="max-width: 70%; margin: 0 auto; display: block;" /></span>
										</div>
									</div>
								</div>

								<ul class="actions special">
									<li><a href="../index.html" class="button large">Back to Projects</a></li>
								</ul>
							</section>

					</div>

				<!-- Footer -->
					<footer id="footer">
						<section class="split contact">
							<section class="alt">
								<h3>Address</h3>
								<p>Copenhagen, Denmark<br />
								</p>
							</section>
							<section>
								<h3>Email</h3>
								<p><a href="#">miki.sapek@gmail.com</a></p>
							</section>
							<section>
								<h3>Social</h3>
								<ul class="icons alt">
									<li><a href="https://www.linkedin.com/in/miko%C5%82aj-pawe%C5%82-sapek-8b5633267/" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
							        <li><a href="https://www.facebook.com/profile.php?id=100009058364906" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
								</ul>
							</section>
						</section>
					</footer>

				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; Mikolaj Pawel Sapek</li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>
			
			<script>
			// Smooth scroll dla całej strony
			document.documentElement.style.scrollBehavior = 'smooth';

			// Dark Mode Toggle
			(function() {
				const darkModeToggle = document.getElementById('dark-mode-toggle');
				const darkModeIcon = document.getElementById('dark-mode-icon');
				
				// Check for saved theme preference or default to light mode
				const currentTheme = localStorage.getItem('theme') || 'light';
				
				if (currentTheme === 'dark') {
					document.body.classList.add('dark-mode');
					if (darkModeIcon) {
						darkModeIcon.classList.remove('fa-moon');
						darkModeIcon.classList.add('fa-sun');
					}
				}
				
				if (darkModeToggle && darkModeIcon) {
					darkModeToggle.addEventListener('click', function() {
						document.body.classList.toggle('dark-mode');
						
						if (document.body.classList.contains('dark-mode')) {
							localStorage.setItem('theme', 'dark');
							darkModeIcon.classList.remove('fa-moon');
							darkModeIcon.classList.add('fa-sun');
						} else {
							localStorage.setItem('theme', 'light');
							darkModeIcon.classList.remove('fa-sun');
							darkModeIcon.classList.add('fa-moon');
						}
					});
				}
			})();
			</script>

	</body>
</html>


