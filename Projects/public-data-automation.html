<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Public Data Aggregation Automation - Mikolaj Pawel Sapek Portfolio</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32-rounded.png" />
		<link rel="icon" type="image/png" sizes="64x64" href="../favicon-64-rounded.png" />
		<link rel="shortcut icon" type="image/png" href="../favicon-32-rounded.png" />
		<link rel="stylesheet" href="../assets/css/main.css" />
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
		<style>
			/* Dark Mode Styles */
			body.dark-mode {
				background-color: #1a1a1a;
				color: #e0e0e0;
			}
			
			body.dark-mode #main {
				background-color: #2a2a2a;
				color: #e0e0e0;
			}
			
			body.dark-mode #main > * {
				border-top-color: #404040;
			}
			
			body.dark-mode h1, body.dark-mode h2, body.dark-mode h3, 
			body.dark-mode h4, body.dark-mode h5, body.dark-mode h6 {
				color: #ffffff;
			}
			
			body.dark-mode a {
				color: #e0e0e0;
				border-bottom-color: rgba(224, 224, 224, 0.5);
			}
			
			body.dark-mode a:hover {
				color: #18bfef !important;
			}
			
			body.dark-mode #header {
				background-color: #1a1a1a;
			}
			
			body.dark-mode #nav {
				background-color: #1a1a1a;
			}
			
			body.dark-mode #footer {
				background-color: #1a1a1a;
				color: #e0e0e0;
			}
			
			body.dark-mode #copyright {
				background-color: #1a1a1a;
				color: #e0e0e0;
			}
			
			body.dark-mode .button {
				color: #ffffff !important;
				border-color: #ffffff !important;
				border-style: solid !important;
				box-shadow: inset 0 0 0 2px #ffffff !important;
			}
			
			body.dark-mode .button:hover {
				background-color: #ffffff !important;
				color: #1a1a1a !important;
				border-color: #ffffff !important;
				box-shadow: inset 0 0 0 2px #ffffff !important;
			}
			
			body.dark-mode strong, body.dark-mode b {
				color: #ffffff !important;
			}
			
			/* Dark mode toggle button */
			#dark-mode-toggle {
				transition: transform 0.2s ease;
				cursor: pointer;
			}
			
			#dark-mode-toggle:hover {
				transform: scale(1.1);
			}
		</style>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="../index.html" class="logo">Portfolio</a>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="../index.html">Projects</a></li>
							<li class="active"><a href="public-data-automation.html">Public Data Aggregation</a></li>
							<li><a href="../aboutme.html">About Me</a></li>
							<li><a href="../cv.html">CV</a></li>
						</ul>
						<ul class="icons">
							<li><a href="https://www.linkedin.com/in/miko%C5%82aj-pawe%C5%82-sapek-8b5633267/" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
							<li><a href="https://www.facebook.com/profile.php?id=100009058364906" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
							<li id="dark-mode-toggle" style="cursor: pointer; padding: 0.5em;">
								<span class="icon solid fa-moon" id="dark-mode-icon"></span>
							</li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<section class="post">
								<header class="major">
									<h1>Public Data Aggregation</h1>
									<p>n8n-driven automation that gathers public source information, normalizes key fields, and delivers consistent datasets for market intelligence.</p>
								</header>
								<div class="image main"><img src="../images/meta-image-redd.png" alt="Public Data Aggregation Platform" style="max-width: 70%; margin: 0 auto; display: block;" /></div>
								
								<h2>Overview</h2>
								<p>An automatic aggregation layer for real estate market monitoring that periodically collects narratives from curated public data sources, cleans HTML, extracts key fields using CSS selectors, and structures data through AI modules, then optionally delivers datasets to a backend API.</p>
								<p>The workflow includes consolidating source listings, filtering by target market, fetching detailed content, parsing dates, merging streams, and producing unified output with leasing/sales/construction context ready for analytics.</p>
								
								<h2>Technology Stack</h2>
								<p>The project leverages n8n workflow automation and AI-powered data processing:</p>
								</ul>
									<li><strong>n8n Workflow Automation:</strong> Schedule Trigger, HTTP Request, HTML Extract, Merge, IF, Code (Node.js), Sticky Notes for in-flow documentation</li>
									<li><strong>AI Parsing:</strong> gpt-4o-mini via n8n LangChain nodes, Structured Output Parser for consistent JSON</li>
									<li><strong>CSS Selectors:</strong> Configurable selectors per source group for lists, detail pages, dates, titles, and content</li>
									<li><strong>Backend Integration:</strong> Secure HTTP batching into internal aggregation endpoints</li>
								</ul>

								<h2>Key Features</h2>
								<ul>
									<li>Data harmonization from multiple public sources: fetching links, dates, locations, and content, then merging entries</li>
									<li>Market filtering: regex-based link checks and location guards to maintain regional relevance</li>
									<li>AI structuring: rigid JSON schemas for Property Type, Leasing, Sales, Construction, Certificates, and Market</li>
									<li>Date normalization: conversions and time filters in Code nodes for rolling publication windows</li>
								</ul>

								<h2>Functionality</h2>
								<p>The orchestration performs the following operations:</p>
								<ul>
									<li>Aggregating categorized lists across monitored public sources</li>
									<li>Fetching detailed entries with full HTML payloads and extracting titles plus content</li>
									<li>Deduplicating and merging data streams into a single table of records ready for internal distribution</li>
									<li>Sending results to APIs in an established payload (title, content, date, category, link, market, leasing info)</li>
								</ul>

								<h2>Challenges & Solutions</h2>
								<p>Key challenges encountered and solutions implemented:</p>
								<ul>
									<li><strong>Different DOM structures and selectors:</strong> Created separate HTML Extract paths per source type with clear selectors for links, dates, and content</li>
									<li><strong>Noise and missing data:</strong> AI Output Parser enforces complete structure with empty fields to avoid breaking downstream schema</li>
									<li><strong>Dates in local formats:</strong> Code nodes normalize ranges and filter rolling windows with localized month names</li>
									<li><strong>Incorrect categorization:</strong> Prompt rules and keywords limit hallucinations and enforce caution in assignments</li>
								</ul>

								<h2>Code Example</h2>
								<p>Date filtering logic for entries published in the previous day (Polish month names). Click below to view the code:</p>
								
								<details>
									<summary style="cursor: pointer; font-weight: bold; margin: 1em 0; padding: 0.5em; background: #f4f4f4; border-radius: 4px;">Click to expand Code Example</summary>
									<pre style="margin-top: 1em;"><code>// Filter: entries from the previous day (PL months)
const currentDate = new Date();
const previousDay = new Date();
previousDay.setDate(currentDate.getDate() - 1);
previousDay.setHours(0,0,0,0);

const endOfPreviousDay = new Date(previousDay);
endOfPreviousDay.setHours(23,59,59,999);

const months = ["stycznia","lutego","marca","kwietnia","maja","czerwca",
                "lipca","sierpnia","września","października","listopada","grudnia"];

const fmt = d => `${d.getDate().toString().padStart(2,'0')} ${months[d.getMonth()]} ${d.getFullYear()}`;

console.log("Checking entries from:", fmt(previousDay));

const filtered = items.filter(it => {
  const s = it.json["Date"];
  if (!s) return false;
  const [d, m, y] = s.trim().split(" ");
  const mi = months.indexOf(m.toLowerCase());
  const dt = new Date(parseInt(y), mi, parseInt(d));
  return dt >= previousDay && dt <= endOfPreviousDay;
});

return filtered.map(it => ({ json: { date: it.json["Date"], link: it.json["Link"] } }));
</code></pre>
								</details>

								<h2>Results & Outcomes</h2>
								<p>The project delivers significant value:</p>
								<ul>
									<li>Consistent JSON for analysis: each record has title, date, link, category, market, and Leasing/Sales/Construction sections</li>
									<li>Reduction of manual work: automation of public data processing and metadata extraction ready for CRM/Notion/DB</li>
									<li>Stable pipeline: harmonization of selectors and parsers minimizes errors when layout changes occur</li>
								</ul>

								<h2>Project Highlights</h2>
								<ul>
									<li>Rigid structured output schemas with complete field order, zero missing structure</li>
									<li>Location filters and regex tuned for region-specific public signals</li>
									<li>Multi-source merge, batch POST to API, and preparation for nightly scheduling</li>
								</ul>

								<h2>Use Cases</h2>
								<p>This tool is valuable for:</p>
								<ul>
									<li>Daily market intelligence feeds for internal dashboards</li>
									<li>Automatic entries to CMS/Notion with ready transaction fields</li>
									<li>Monitoring leasing/sales/construction for research and market reports</li>
								<ul>

								<h2>Visualizations</h2>
								<div class="box alt">
									<div class="row gtr-50 gtr-uniform">
										<div class="col-12">
											<h3>n8n Workflow Diagram - Public Data Aggregation</h3>
											<p><em>Complete workflow showing monitored source branches, merge, enrichment, and output stages</em></p>
											<span class="image fit"><img src="../images/Screenshot 2025-11-08 at 13.01.14.png" alt="n8n Workflow Diagram - Public Data Aggregation" style="max-width: 70%; margin: 0 auto; display: block;" /></span>
										</div>
									</div>
								</div>

								<ul class="actions special">
									<li><a href="../index.html" class="button large">Back to Projects</a></li>
								</ul>
							</section>

					</div>

				<!-- Footer -->
					<footer id="footer">
						<section class="split contact">
							<section class="alt">
								<h3>Address</h3>
								<p>Copenhagen, Denmark<br />
								</p>
							</section>
							<section>
								<h3>Email</h3>
								<p><a href="#">miki.sapek@gmail.com</a></p>
							</section>
							<section>
								<h3>Social</h3>
								<ul class="icons alt">
									<li><a href="https://www.linkedin.com/in/miko%C5%82aj-pawe%C5%82-sapek-8b5633267/" class="icon brands alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
							        <li><a href="https://www.facebook.com/profile.php?id=100009058364906" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
								</ul>
							</section>
						</section>
					</footer>

				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; Mikolaj Pawel Sapek</li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>
			
			<script>
			// Smooth scroll dla całej strony
			document.documentElement.style.scrollBehavior = 'smooth';

			// Dark Mode Toggle
			(function() {
				const darkModeToggle = document.getElementById('dark-mode-toggle');
				const darkModeIcon = document.getElementById('dark-mode-icon');
				
				// Check for saved theme preference or default to light mode
				const currentTheme = localStorage.getItem('theme') || 'light';
				
				if (currentTheme === 'dark') {
					document.body.classList.add('dark-mode');
					if (darkModeIcon) {
						darkModeIcon.classList.remove('fa-moon');
						darkModeIcon.classList.add('fa-sun');
					}
				}
				
				if (darkModeToggle && darkModeIcon) {
					darkModeToggle.addEventListener('click', function() {
						document.body.classList.toggle('dark-mode');
						
						if (document.body.classList.contains('dark-mode')) {
							localStorage.setItem('theme', 'dark');
							darkModeIcon.classList.remove('fa-moon');
							darkModeIcon.classList.add('fa-sun');
						} else {
							localStorage.setItem('theme', 'light');
							darkModeIcon.classList.remove('fa-sun');
							darkModeIcon.classList.add('fa-moon');
						}
					});
				}
			})();
			</script>

	</body>
</html>

